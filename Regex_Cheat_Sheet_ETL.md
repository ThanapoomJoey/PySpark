
# üìò Regex Cheat Sheet ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ETL (PySpark / SQL)

‡∏£‡∏ß‡∏° 10 regex ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢‡πÉ‡∏ô‡∏á‡∏≤‡∏ô Data Engineer, ETL, ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢ PySpark ‡∏´‡∏£‡∏∑‡∏≠ SQL

---

## ‚úÖ 1. ‡∏î‡∏∂‡∏á‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏à‡∏≤‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡πá‡∏° (First Last)

```python
regexp_extract(col("full_name"), r"^\w+\s+(\w+)", 1)
```
üìå ‡∏î‡∏∂‡∏á‡∏Ñ‡∏≥‡∏´‡∏•‡∏±‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á ‡πÄ‡∏ä‡πà‡∏ô `"John Smith"` ‚Üí `"Smith"`

---

## ‚úÖ 2. ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠ (First Name) ‡∏à‡∏≤‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡πá‡∏°

```python
regexp_extract(col("full_name"), r"^(\w+)", 1)
```
üìå ‡∏î‡∏∂‡∏á‡∏Ñ‡∏≥‡πÅ‡∏£‡∏Å ‡πÄ‡∏ä‡πà‡∏ô `"John Smith"` ‚Üí `"John"`

---

## ‚úÖ 3. ‡∏î‡∏∂‡∏á Domain ‡∏à‡∏≤‡∏Å Email

```python
regexp_extract(col("email"), r"@([\w\.]+)$", 1)
```
üìå `"joe@gmail.com"` ‚Üí `"gmail.com"`

---

## ‚úÖ 4. ‡∏î‡∏∂‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‡πÄ‡∏ä‡πà‡∏ô ID

```python
regexp_extract(col("employee_id"), r"(\d+)", 1)
```
üìå `"ID_00123"` ‚Üí `"00123"`

---

## ‚úÖ 5. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡πâ‡∏ß‡∏¢ A-Z (‡πÑ‡∏°‡πà‡∏î‡∏∂‡∏á ‡πÅ‡∏Ñ‡πà‡∏ï‡∏£‡∏ß‡∏à)

```sql
column RLIKE '^[A-Z]'
```
üìå ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÉ‡∏´‡∏ç‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

---

## ‚úÖ 6. ‡∏î‡∏∂‡∏á‡∏õ‡∏µ‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡∏ö `YYYY-MM-DD`

```python
regexp_extract(col("date"), r"(\d{4})-\d{2}-\d{2}", 1)
```
üìå `"2023-12-31"` ‚Üí `"2023"`

---

## ‚úÖ 7. ‡∏î‡∏∂‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà

```python
regexp_extract(col("date"), r"\d{4}-(\d{2})-\d{2}", 1)
```
üìå `"2023-12-31"` ‚Üí `"12"`

---

## ‚úÖ 8. ‡∏î‡∏∂‡∏á‡∏Ñ‡∏≥‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°

```python
regexp_extract(col("sentence"), r"(\w+)$", 1)
```
üìå `"hello world"` ‚Üí `"world"`

---

## ‚úÖ 9. ‡∏î‡∏∂‡∏á‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå 5 ‡∏´‡∏•‡∏±‡∏Å

```python
regexp_extract(col("address"), r"(\d{5})", 1)
```
üìå `"Bangkok 10200"` ‚Üí `"10200"`

---

## ‚úÖ 10. ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö

```python
regexp_extract(col("note"), r"\(([^)]+)\)", 1)
```
üìå `"Price (USD)"` ‚Üí `"USD"`

---

## üß† Tips:
- `(\w+)`: ‡∏à‡∏±‡∏ö‡∏Ñ‡∏≥
- `(\d+)`: ‡∏à‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
- `^`, `$`: ‡πÄ‡∏£‡∏¥‡πà‡∏° / ‡∏à‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
- `+`, `{n}`: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
- `[A-Z]`, `[a-z]`, `[0-9]`: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£/‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
- `[^)]`: ‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô `)`

## üß† ‡∏™‡∏£‡∏∏‡∏õ Quantifier ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢‡πÉ‡∏ô Regex

| Quantifier | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢                           |
|------------|-------------------------------------|
| `.`        | ‡∏ï‡∏±‡∏ß‡πÉ‡∏î‡∏Å‡πá‡πÑ‡∏î‡πâ 1 ‡∏ï‡∏±‡∏ß                   |
| `+`        | ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏ï‡∏±‡∏ß                    |
| `*`        | 0 ‡∏ï‡∏±‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ                         |
| `{n}`      | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏õ‡πä‡∏∞ ‡πÜ (‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç n ‡∏ï‡∏±‡∏ß) |
| `{n,m}`    | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á n ‡∏ñ‡∏∂‡∏á m ‡∏ï‡∏±‡∏ß          |
| `\w`       | ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç (word)         |
| `\d`       | ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç (digit)                     |
| `\s`       | ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á (space)                   |

---

## üß™ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:

- `\d{3}`: ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 3 ‡∏ï‡∏±‡∏ß ‡πÄ‡∏ä‡πà‡∏ô `123`
- `\w+`: ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 1 ‡∏ï‡∏±‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ ‡πÄ‡∏ä‡πà‡∏ô `abc123`
- `\s*`: ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á 0 ‡∏ï‡∏±‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ ‡πÄ‡∏ä‡πà‡∏ô `   ` ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏•‡∏¢


---

## üß™ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÉ‡∏ô PySpark

```python
from pyspark.sql.functions import regexp_extract

df.withColumn("last_name", regexp_extract("full_name", r"^\w+\s+(\w+)", 1)).show()
```

---

## üìç ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏Å‡∏±‡∏ö:
- PySpark: `regexp_extract()`
- Spark SQL: `REGEXP_EXTRACT(col, pattern, group)`
- SQL ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ: `REGEXP_EXTRACT()` ‡∏´‡∏£‡∏∑‡∏≠ `RLIKE`

---
